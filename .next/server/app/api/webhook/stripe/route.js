"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/webhook/stripe/route";
exports.ids = ["app/api/webhook/stripe/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Fstripe%2Froute&page=%2Fapi%2Fwebhook%2Fstripe%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Fstripe%2Froute.ts&appDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Fstripe%2Froute&page=%2Fapi%2Fwebhook%2Fstripe%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Fstripe%2Froute.ts&appDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var c_Users_maddo_Desktop_ir_new_app_api_webhook_stripe_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/webhook/stripe/route.ts */ \"(rsc)/./app/api/webhook/stripe/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/webhook/stripe/route\",\n        pathname: \"/api/webhook/stripe\",\n        filename: \"route\",\n        bundlePath: \"app/api/webhook/stripe/route\"\n    },\n    resolvedPagePath: \"c:\\\\Users\\\\maddo\\\\Desktop\\\\ir_new\\\\app\\\\api\\\\webhook\\\\stripe\\\\route.ts\",\n    nextConfigOutput,\n    userland: c_Users_maddo_Desktop_ir_new_app_api_webhook_stripe_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/webhook/stripe/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3ZWJob29rJTJGc3RyaXBlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ3ZWJob29rJTJGc3RyaXBlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd2ViaG9vayUyRnN0cmlwZSUyRnJvdXRlLnRzJmFwcERpcj1jJTNBJTVDVXNlcnMlNUNtYWRkbyU1Q0Rlc2t0b3AlNUNpcl9uZXclNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPWMlM0ElNUNVc2VycyU1Q21hZGRvJTVDRGVza3RvcCU1Q2lyX25ldyZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDc0I7QUFDbkc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pcl9uZXcvP2ZjNTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiYzpcXFxcVXNlcnNcXFxcbWFkZG9cXFxcRGVza3RvcFxcXFxpcl9uZXdcXFxcYXBwXFxcXGFwaVxcXFx3ZWJob29rXFxcXHN0cmlwZVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2ViaG9vay9zdHJpcGUvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS93ZWJob29rL3N0cmlwZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvd2ViaG9vay9zdHJpcGUvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJjOlxcXFxVc2Vyc1xcXFxtYWRkb1xcXFxEZXNrdG9wXFxcXGlyX25ld1xcXFxhcHBcXFxcYXBpXFxcXHdlYmhvb2tcXFxcc3RyaXBlXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS93ZWJob29rL3N0cmlwZS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Fstripe%2Froute&page=%2Fapi%2Fwebhook%2Fstripe%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Fstripe%2Froute.ts&appDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/webhook/stripe/route.ts":
/*!*****************************************!*\
  !*** ./app/api/webhook/stripe/route.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n\nconst stripe = new stripe__WEBPACK_IMPORTED_MODULE_1__[\"default\"](process.env.STRIPE_SECRET_KEY, {\n    apiVersion: \"2024-12-18.acacia\"\n});\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://wjhdvjukspfgoojyloks.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY);\nconst webhookSecret = process.env.STRIPE_WEBHOOK_SECRET;\nasync function POST(req) {\n    try {\n        const body = await req.text();\n        const signature = req.headers.get(\"stripe-signature\");\n        if (!signature) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No signature\"\n            }, {\n                status: 400\n            });\n        }\n        // Verify webhook signature\n        let event;\n        try {\n            event = stripe.webhooks.constructEvent(body, signature, webhookSecret);\n        } catch (err) {\n            console.error(\"Webhook signature verification failed:\", err.message);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid signature\"\n            }, {\n                status: 400\n            });\n        }\n        // Handle the event\n        switch(event.type){\n            case \"checkout.session.completed\":\n                {\n                    const session = event.data.object;\n                    await handleCheckoutCompleted(session);\n                    break;\n                }\n            case \"customer.subscription.updated\":\n                {\n                    const subscription = event.data.object;\n                    await handleSubscriptionUpdated(subscription);\n                    break;\n                }\n            case \"customer.subscription.deleted\":\n                {\n                    const subscription = event.data.object;\n                    await handleSubscriptionDeleted(subscription);\n                    break;\n                }\n            case \"invoice.payment_succeeded\":\n                {\n                    const invoice = event.data.object;\n                    await handlePaymentSucceeded(invoice);\n                    break;\n                }\n            case \"invoice.payment_failed\":\n                {\n                    const invoice = event.data.object;\n                    await handlePaymentFailed(invoice);\n                    break;\n                }\n            default:\n                console.log(`Unhandled event type: ${event.type}`);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            received: true\n        });\n    } catch (error) {\n        console.error(\"Webhook error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: error.message || \"Webhook handler failed\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleCheckoutCompleted(session) {\n    const userId = session.metadata?.supabase_user_id;\n    const tier = session.metadata?.tier;\n    const cycle = session.metadata?.cycle;\n    if (!userId || !tier || !cycle) {\n        console.error(\"Missing metadata in checkout session:\", session.id);\n        return;\n    }\n    // Get subscription details\n    const subscriptionId = session.subscription;\n    const subscription = await stripe.subscriptions.retrieve(subscriptionId);\n    // Update user profile\n    await supabase.rpc(\"apply_subscription_update\", {\n        p_user_id: userId,\n        p_status: \"active\",\n        p_tier: tier,\n        p_cycle: cycle,\n        p_customer_id: session.customer,\n        p_subscription_id: subscriptionId,\n        p_trial_end: subscription.trial_end ? new Date(subscription.trial_end * 1000).toISOString() : null\n    });\n    console.log(`Subscription activated for user ${userId}: ${tier} ${cycle}`);\n}\nasync function handleSubscriptionUpdated(subscription) {\n    const userId = subscription.metadata?.supabase_user_id;\n    const tier = subscription.metadata?.tier;\n    const cycle = subscription.metadata?.cycle;\n    if (!userId) {\n        console.error(\"Missing user ID in subscription metadata:\", subscription.id);\n        return;\n    }\n    let status;\n    switch(subscription.status){\n        case \"active\":\n            status = \"active\";\n            break;\n        case \"past_due\":\n            status = \"past_due\";\n            break;\n        case \"canceled\":\n            status = \"canceled\";\n            break;\n        case \"trialing\":\n            status = \"trialing\";\n            break;\n        default:\n            status = subscription.status;\n    }\n    await supabase.rpc(\"apply_subscription_update\", {\n        p_user_id: userId,\n        p_status: status,\n        p_tier: tier || \"basic\",\n        p_cycle: cycle || \"monthly\",\n        p_customer_id: subscription.customer,\n        p_subscription_id: subscription.id,\n        p_trial_end: subscription.trial_end ? new Date(subscription.trial_end * 1000).toISOString() : null\n    });\n    console.log(`Subscription updated for user ${userId}: ${status}`);\n}\nasync function handleSubscriptionDeleted(subscription) {\n    const userId = subscription.metadata?.supabase_user_id;\n    if (!userId) {\n        console.error(\"Missing user ID in subscription metadata:\", subscription.id);\n        return;\n    }\n    // Set user back to trial tier with canceled status\n    await supabase.from(\"profiles\").update({\n        subscription_tier: \"trial\",\n        subscription_status: \"canceled\",\n        subscription_ends_at: new Date().toISOString()\n    }).eq(\"id\", userId);\n    console.log(`Subscription canceled for user ${userId}`);\n}\nasync function handlePaymentSucceeded(invoice) {\n    const subscriptionId = invoice.subscription;\n    if (!subscriptionId) return;\n    const subscription = await stripe.subscriptions.retrieve(subscriptionId);\n    const userId = subscription.metadata?.supabase_user_id;\n    if (!userId) return;\n    // Update subscription status to active\n    await supabase.from(\"profiles\").update({\n        subscription_status: \"active\"\n    }).eq(\"id\", userId);\n    console.log(`Payment succeeded for user ${userId}`);\n}\nasync function handlePaymentFailed(invoice) {\n    const subscriptionId = invoice.subscription;\n    if (!subscriptionId) return;\n    const subscription = await stripe.subscriptions.retrieve(subscriptionId);\n    const userId = subscription.metadata?.supabase_user_id;\n    if (!userId) return;\n    // Update subscription status to past_due\n    await supabase.from(\"profiles\").update({\n        subscription_status: \"past_due\"\n    }).eq(\"id\", userId);\n    console.log(`Payment failed for user ${userId}`);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNjLGdCQUFnQjtJQUVyQixNQUFNZCxlQUFlLE1BQU0vQixPQUFPOEMsYUFBYSxDQUFDQyxRQUFRLENBQUNGO0lBQ3pELE1BQU1OLFNBQVNSLGFBQWFTLFFBQVEsRUFBRUM7SUFFdEMsSUFBSSxDQUFDRixRQUFRO0lBRWIseUNBQXlDO0lBQ3pDLE1BQU1sQyxTQUNIdUQsSUFBSSxDQUFDLFlBQ0xDLE1BQU0sQ0FBQztRQUFFRSxxQkFBcUI7SUFBVyxHQUN6Q0UsRUFBRSxDQUFDLE1BQU0xQjtJQUVaZixRQUFRYSxHQUFHLENBQUMsQ0FBQyx3QkFBd0IsRUFBRUUsT0FBTyxDQUFDO0FBQ2pEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaXJfbmV3Ly4vYXBwL2FwaS93ZWJob29rL3N0cmlwZS9yb3V0ZS50cz9iNTg1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcclxuaW1wb3J0IFN0cmlwZSBmcm9tIFwic3RyaXBlXCI7XHJcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3VwYWJhc2UtanNcIjtcclxuXHJcbmNvbnN0IHN0cmlwZSA9IG5ldyBTdHJpcGUocHJvY2Vzcy5lbnYuU1RSSVBFX1NFQ1JFVF9LRVkhLCB7XHJcbiAgYXBpVmVyc2lvbjogXCIyMDI0LTEyLTE4LmFjYWNpYVwiLFxyXG59KTtcclxuXHJcbmNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KFxyXG4gIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXHJcbiAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSFcclxuKTtcclxuXHJcbmNvbnN0IHdlYmhvb2tTZWNyZXQgPSBwcm9jZXNzLmVudi5TVFJJUEVfV0VCSE9PS19TRUNSRVQhO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxLnRleHQoKTtcclxuICAgIGNvbnN0IHNpZ25hdHVyZSA9IHJlcS5oZWFkZXJzLmdldChcInN0cmlwZS1zaWduYXR1cmVcIik7XHJcblxyXG4gICAgaWYgKCFzaWduYXR1cmUpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IFwiTm8gc2lnbmF0dXJlXCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBWZXJpZnkgd2ViaG9vayBzaWduYXR1cmVcclxuICAgIGxldCBldmVudDogU3RyaXBlLkV2ZW50O1xyXG4gICAgdHJ5IHtcclxuICAgICAgZXZlbnQgPSBzdHJpcGUud2ViaG9va3MuY29uc3RydWN0RXZlbnQoYm9keSwgc2lnbmF0dXJlLCB3ZWJob29rU2VjcmV0KTtcclxuICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJXZWJob29rIHNpZ25hdHVyZSB2ZXJpZmljYXRpb24gZmFpbGVkOlwiLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkludmFsaWQgc2lnbmF0dXJlXCIgfSwgeyBzdGF0dXM6IDQwMCB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBIYW5kbGUgdGhlIGV2ZW50XHJcbiAgICBzd2l0Y2ggKGV2ZW50LnR5cGUpIHtcclxuICAgICAgY2FzZSBcImNoZWNrb3V0LnNlc3Npb24uY29tcGxldGVkXCI6IHtcclxuICAgICAgICBjb25zdCBzZXNzaW9uID0gZXZlbnQuZGF0YS5vYmplY3QgYXMgU3RyaXBlLkNoZWNrb3V0LlNlc3Npb247XHJcbiAgICAgICAgYXdhaXQgaGFuZGxlQ2hlY2tvdXRDb21wbGV0ZWQoc2Vzc2lvbik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhc2UgXCJjdXN0b21lci5zdWJzY3JpcHRpb24udXBkYXRlZFwiOiB7XHJcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gZXZlbnQuZGF0YS5vYmplY3QgYXMgU3RyaXBlLlN1YnNjcmlwdGlvbjtcclxuICAgICAgICBhd2FpdCBoYW5kbGVTdWJzY3JpcHRpb25VcGRhdGVkKHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhc2UgXCJjdXN0b21lci5zdWJzY3JpcHRpb24uZGVsZXRlZFwiOiB7XHJcbiAgICAgICAgY29uc3Qgc3Vic2NyaXB0aW9uID0gZXZlbnQuZGF0YS5vYmplY3QgYXMgU3RyaXBlLlN1YnNjcmlwdGlvbjtcclxuICAgICAgICBhd2FpdCBoYW5kbGVTdWJzY3JpcHRpb25EZWxldGVkKHN1YnNjcmlwdGlvbik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNhc2UgXCJpbnZvaWNlLnBheW1lbnRfc3VjY2VlZGVkXCI6IHtcclxuICAgICAgICBjb25zdCBpbnZvaWNlID0gZXZlbnQuZGF0YS5vYmplY3QgYXMgU3RyaXBlLkludm9pY2U7XHJcbiAgICAgICAgYXdhaXQgaGFuZGxlUGF5bWVudFN1Y2NlZWRlZChpbnZvaWNlKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgY2FzZSBcImludm9pY2UucGF5bWVudF9mYWlsZWRcIjoge1xyXG4gICAgICAgIGNvbnN0IGludm9pY2UgPSBldmVudC5kYXRhLm9iamVjdCBhcyBTdHJpcGUuSW52b2ljZTtcclxuICAgICAgICBhd2FpdCBoYW5kbGVQYXltZW50RmFpbGVkKGludm9pY2UpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBVbmhhbmRsZWQgZXZlbnQgdHlwZTogJHtldmVudC50eXBlfWApO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJlY2VpdmVkOiB0cnVlIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJXZWJob29rIGVycm9yOlwiLCBlcnJvcik7XHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgXCJXZWJob29rIGhhbmRsZXIgZmFpbGVkXCIgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ2hlY2tvdXRDb21wbGV0ZWQoc2Vzc2lvbjogU3RyaXBlLkNoZWNrb3V0LlNlc3Npb24pIHtcclxuICBjb25zdCB1c2VySWQgPSBzZXNzaW9uLm1ldGFkYXRhPy5zdXBhYmFzZV91c2VyX2lkO1xyXG4gIGNvbnN0IHRpZXIgPSBzZXNzaW9uLm1ldGFkYXRhPy50aWVyO1xyXG4gIGNvbnN0IGN5Y2xlID0gc2Vzc2lvbi5tZXRhZGF0YT8uY3ljbGU7XHJcblxyXG4gIGlmICghdXNlcklkIHx8ICF0aWVyIHx8ICFjeWNsZSkge1xyXG4gICAgY29uc29sZS5lcnJvcihcIk1pc3NpbmcgbWV0YWRhdGEgaW4gY2hlY2tvdXQgc2Vzc2lvbjpcIiwgc2Vzc2lvbi5pZCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgc3Vic2NyaXB0aW9uIGRldGFpbHNcclxuICBjb25zdCBzdWJzY3JpcHRpb25JZCA9IHNlc3Npb24uc3Vic2NyaXB0aW9uIGFzIHN0cmluZztcclxuICBjb25zdCBzdWJzY3JpcHRpb24gPSBhd2FpdCBzdHJpcGUuc3Vic2NyaXB0aW9ucy5yZXRyaWV2ZShzdWJzY3JpcHRpb25JZCk7XHJcblxyXG4gIC8vIFVwZGF0ZSB1c2VyIHByb2ZpbGVcclxuICBhd2FpdCBzdXBhYmFzZS5ycGMoXCJhcHBseV9zdWJzY3JpcHRpb25fdXBkYXRlXCIsIHtcclxuICAgIHBfdXNlcl9pZDogdXNlcklkLFxyXG4gICAgcF9zdGF0dXM6IFwiYWN0aXZlXCIsXHJcbiAgICBwX3RpZXI6IHRpZXIsXHJcbiAgICBwX2N5Y2xlOiBjeWNsZSxcclxuICAgIHBfY3VzdG9tZXJfaWQ6IHNlc3Npb24uY3VzdG9tZXIgYXMgc3RyaW5nLFxyXG4gICAgcF9zdWJzY3JpcHRpb25faWQ6IHN1YnNjcmlwdGlvbklkLFxyXG4gICAgcF90cmlhbF9lbmQ6IHN1YnNjcmlwdGlvbi50cmlhbF9lbmRcclxuICAgICAgPyBuZXcgRGF0ZShzdWJzY3JpcHRpb24udHJpYWxfZW5kICogMTAwMCkudG9JU09TdHJpbmcoKVxyXG4gICAgICA6IG51bGwsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKGBTdWJzY3JpcHRpb24gYWN0aXZhdGVkIGZvciB1c2VyICR7dXNlcklkfTogJHt0aWVyfSAke2N5Y2xlfWApO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTdWJzY3JpcHRpb25VcGRhdGVkKHN1YnNjcmlwdGlvbjogU3RyaXBlLlN1YnNjcmlwdGlvbikge1xyXG4gIGNvbnN0IHVzZXJJZCA9IHN1YnNjcmlwdGlvbi5tZXRhZGF0YT8uc3VwYWJhc2VfdXNlcl9pZDtcclxuICBjb25zdCB0aWVyID0gc3Vic2NyaXB0aW9uLm1ldGFkYXRhPy50aWVyO1xyXG4gIGNvbnN0IGN5Y2xlID0gc3Vic2NyaXB0aW9uLm1ldGFkYXRhPy5jeWNsZTtcclxuXHJcbiAgaWYgKCF1c2VySWQpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJNaXNzaW5nIHVzZXIgSUQgaW4gc3Vic2NyaXB0aW9uIG1ldGFkYXRhOlwiLCBzdWJzY3JpcHRpb24uaWQpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgbGV0IHN0YXR1czogc3RyaW5nO1xyXG4gIHN3aXRjaCAoc3Vic2NyaXB0aW9uLnN0YXR1cykge1xyXG4gICAgY2FzZSBcImFjdGl2ZVwiOlxyXG4gICAgICBzdGF0dXMgPSBcImFjdGl2ZVwiO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgXCJwYXN0X2R1ZVwiOlxyXG4gICAgICBzdGF0dXMgPSBcInBhc3RfZHVlXCI7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSBcImNhbmNlbGVkXCI6XHJcbiAgICAgIHN0YXR1cyA9IFwiY2FuY2VsZWRcIjtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIFwidHJpYWxpbmdcIjpcclxuICAgICAgc3RhdHVzID0gXCJ0cmlhbGluZ1wiO1xyXG4gICAgICBicmVhaztcclxuICAgIGRlZmF1bHQ6XHJcbiAgICAgIHN0YXR1cyA9IHN1YnNjcmlwdGlvbi5zdGF0dXM7XHJcbiAgfVxyXG5cclxuICBhd2FpdCBzdXBhYmFzZS5ycGMoXCJhcHBseV9zdWJzY3JpcHRpb25fdXBkYXRlXCIsIHtcclxuICAgIHBfdXNlcl9pZDogdXNlcklkLFxyXG4gICAgcF9zdGF0dXM6IHN0YXR1cyxcclxuICAgIHBfdGllcjogdGllciB8fCBcImJhc2ljXCIsXHJcbiAgICBwX2N5Y2xlOiBjeWNsZSB8fCBcIm1vbnRobHlcIixcclxuICAgIHBfY3VzdG9tZXJfaWQ6IHN1YnNjcmlwdGlvbi5jdXN0b21lciBhcyBzdHJpbmcsXHJcbiAgICBwX3N1YnNjcmlwdGlvbl9pZDogc3Vic2NyaXB0aW9uLmlkLFxyXG4gICAgcF90cmlhbF9lbmQ6IHN1YnNjcmlwdGlvbi50cmlhbF9lbmRcclxuICAgICAgPyBuZXcgRGF0ZShzdWJzY3JpcHRpb24udHJpYWxfZW5kICogMTAwMCkudG9JU09TdHJpbmcoKVxyXG4gICAgICA6IG51bGwsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKGBTdWJzY3JpcHRpb24gdXBkYXRlZCBmb3IgdXNlciAke3VzZXJJZH06ICR7c3RhdHVzfWApO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVTdWJzY3JpcHRpb25EZWxldGVkKHN1YnNjcmlwdGlvbjogU3RyaXBlLlN1YnNjcmlwdGlvbikge1xyXG4gIGNvbnN0IHVzZXJJZCA9IHN1YnNjcmlwdGlvbi5tZXRhZGF0YT8uc3VwYWJhc2VfdXNlcl9pZDtcclxuXHJcbiAgaWYgKCF1c2VySWQpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJNaXNzaW5nIHVzZXIgSUQgaW4gc3Vic2NyaXB0aW9uIG1ldGFkYXRhOlwiLCBzdWJzY3JpcHRpb24uaWQpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgLy8gU2V0IHVzZXIgYmFjayB0byB0cmlhbCB0aWVyIHdpdGggY2FuY2VsZWQgc3RhdHVzXHJcbiAgYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKFwicHJvZmlsZXNcIilcclxuICAgIC51cGRhdGUoe1xyXG4gICAgICBzdWJzY3JpcHRpb25fdGllcjogXCJ0cmlhbFwiLFxyXG4gICAgICBzdWJzY3JpcHRpb25fc3RhdHVzOiBcImNhbmNlbGVkXCIsXHJcbiAgICAgIHN1YnNjcmlwdGlvbl9lbmRzX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9KVxyXG4gICAgLmVxKFwiaWRcIiwgdXNlcklkKTtcclxuXHJcbiAgY29uc29sZS5sb2coYFN1YnNjcmlwdGlvbiBjYW5jZWxlZCBmb3IgdXNlciAke3VzZXJJZH1gKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUGF5bWVudFN1Y2NlZWRlZChpbnZvaWNlOiBTdHJpcGUuSW52b2ljZSkge1xyXG4gIGNvbnN0IHN1YnNjcmlwdGlvbklkID0gaW52b2ljZS5zdWJzY3JpcHRpb24gYXMgc3RyaW5nO1xyXG4gIGlmICghc3Vic2NyaXB0aW9uSWQpIHJldHVybjtcclxuXHJcbiAgY29uc3Qgc3Vic2NyaXB0aW9uID0gYXdhaXQgc3RyaXBlLnN1YnNjcmlwdGlvbnMucmV0cmlldmUoc3Vic2NyaXB0aW9uSWQpO1xyXG4gIGNvbnN0IHVzZXJJZCA9IHN1YnNjcmlwdGlvbi5tZXRhZGF0YT8uc3VwYWJhc2VfdXNlcl9pZDtcclxuXHJcbiAgaWYgKCF1c2VySWQpIHJldHVybjtcclxuXHJcbiAgLy8gVXBkYXRlIHN1YnNjcmlwdGlvbiBzdGF0dXMgdG8gYWN0aXZlXHJcbiAgYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKFwicHJvZmlsZXNcIilcclxuICAgIC51cGRhdGUoeyBzdWJzY3JpcHRpb25fc3RhdHVzOiBcImFjdGl2ZVwiIH0pXHJcbiAgICAuZXEoXCJpZFwiLCB1c2VySWQpO1xyXG5cclxuICBjb25zb2xlLmxvZyhgUGF5bWVudCBzdWNjZWVkZWQgZm9yIHVzZXIgJHt1c2VySWR9YCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVBheW1lbnRGYWlsZWQoaW52b2ljZTogU3RyaXBlLkludm9pY2UpIHtcclxuICBjb25zdCBzdWJzY3JpcHRpb25JZCA9IGludm9pY2Uuc3Vic2NyaXB0aW9uIGFzIHN0cmluZztcclxuICBpZiAoIXN1YnNjcmlwdGlvbklkKSByZXR1cm47XHJcblxyXG4gIGNvbnN0IHN1YnNjcmlwdGlvbiA9IGF3YWl0IHN0cmlwZS5zdWJzY3JpcHRpb25zLnJldHJpZXZlKHN1YnNjcmlwdGlvbklkKTtcclxuICBjb25zdCB1c2VySWQgPSBzdWJzY3JpcHRpb24ubWV0YWRhdGE/LnN1cGFiYXNlX3VzZXJfaWQ7XHJcblxyXG4gIGlmICghdXNlcklkKSByZXR1cm47XHJcblxyXG4gIC8vIFVwZGF0ZSBzdWJzY3JpcHRpb24gc3RhdHVzIHRvIHBhc3RfZHVlXHJcbiAgYXdhaXQgc3VwYWJhc2VcclxuICAgIC5mcm9tKFwicHJvZmlsZXNcIilcclxuICAgIC51cGRhdGUoeyBzdWJzY3JpcHRpb25fc3RhdHVzOiBcInBhc3RfZHVlXCIgfSlcclxuICAgIC5lcShcImlkXCIsIHVzZXJJZCk7XHJcblxyXG4gIGNvbnNvbGUubG9nKGBQYXltZW50IGZhaWxlZCBmb3IgdXNlciAke3VzZXJJZH1gKTtcclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiU3RyaXBlIiwiY3JlYXRlQ2xpZW50Iiwic3RyaXBlIiwicHJvY2VzcyIsImVudiIsIlNUUklQRV9TRUNSRVRfS0VZIiwiYXBpVmVyc2lvbiIsInN1cGFiYXNlIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsIndlYmhvb2tTZWNyZXQiLCJTVFJJUEVfV0VCSE9PS19TRUNSRVQiLCJQT1NUIiwicmVxIiwiYm9keSIsInRleHQiLCJzaWduYXR1cmUiLCJoZWFkZXJzIiwiZ2V0IiwianNvbiIsImVycm9yIiwic3RhdHVzIiwiZXZlbnQiLCJ3ZWJob29rcyIsImNvbnN0cnVjdEV2ZW50IiwiZXJyIiwiY29uc29sZSIsIm1lc3NhZ2UiLCJ0eXBlIiwic2Vzc2lvbiIsImRhdGEiLCJvYmplY3QiLCJoYW5kbGVDaGVja291dENvbXBsZXRlZCIsInN1YnNjcmlwdGlvbiIsImhhbmRsZVN1YnNjcmlwdGlvblVwZGF0ZWQiLCJoYW5kbGVTdWJzY3JpcHRpb25EZWxldGVkIiwiaW52b2ljZSIsImhhbmRsZVBheW1lbnRTdWNjZWVkZWQiLCJoYW5kbGVQYXltZW50RmFpbGVkIiwibG9nIiwicmVjZWl2ZWQiLCJ1c2VySWQiLCJtZXRhZGF0YSIsInN1cGFiYXNlX3VzZXJfaWQiLCJ0aWVyIiwiY3ljbGUiLCJpZCIsInN1YnNjcmlwdGlvbklkIiwic3Vic2NyaXB0aW9ucyIsInJldHJpZXZlIiwicnBjIiwicF91c2VyX2lkIiwicF9zdGF0dXMiLCJwX3RpZXIiLCJwX2N5Y2xlIiwicF9jdXN0b21lcl9pZCIsImN1c3RvbWVyIiwicF9zdWJzY3JpcHRpb25faWQiLCJwX3RyaWFsX2VuZCIsInRyaWFsX2VuZCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImZyb20iLCJ1cGRhdGUiLCJzdWJzY3JpcHRpb25fdGllciIsInN1YnNjcmlwdGlvbl9zdGF0dXMiLCJzdWJzY3JpcHRpb25fZW5kc19hdCIsImVxIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/webhook/stripe/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/tslib","vendor-chunks/stripe","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/qs","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/object-inspect","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/side-channel","vendor-chunks/side-channel-weakmap","vendor-chunks/side-channel-map","vendor-chunks/side-channel-list","vendor-chunks/hasown","vendor-chunks/get-intrinsic","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/call-bound"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwebhook%2Fstripe%2Froute&page=%2Fapi%2Fwebhook%2Fstripe%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwebhook%2Fstripe%2Froute.ts&appDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=c%3A%5CUsers%5Cmaddo%5CDesktop%5Cir_new&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();